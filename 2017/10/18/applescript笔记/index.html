<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="探寻设计的尺度"><title>applescript笔记 | 有度</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="header-limit"><div class="site-name"><h1 class="hidden">applescript笔记</h1><a class="logo-brand" href="/." rel="home"><img class="logo nofancybox" src="/img/logo.svg" alt="yodu"></a></div><div id="nav-menu"><a href="/."><i class="fa null"> 首页</i></a><a href="/categories/设计/"><i class="fa null"> 设计</i></a><a href="/categories/编程/"><i class="fa null"> 编程</i></a><a href="/categories/随笔/"><i class="fa null"> 随笔</i></a><a href="/about/"><i class="fa null"> 关于</i></a></div></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">applescript笔记</h1><div class="post-meta">2017-10-18<span class="category"><a href="/categories/编程/">编程</a></span></div><div class="clear"><div class="toc-article" id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#常用功能"><span class="toc-text">常用功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#激活应用"><span class="toc-text">激活应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#延时"><span class="toc-text">延时</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#路径转换"><span class="toc-text">路径转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文本编辑"><span class="toc-text">文本编辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Finder-调用"><span class="toc-text">Finder 调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#捕捉错误"><span class="toc-text">捕捉错误</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据类型"><span class="toc-text">数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#变量"><span class="toc-text">变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串处理"><span class="toc-text">字符串处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#list-数组"><span class="toc-text">list 数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#record-字典"><span class="toc-text">record 字典</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#日期时间"><span class="toc-text">日期时间</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#流程控制"><span class="toc-text">流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#条件语句"><span class="toc-text">条件语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#循环语句"><span class="toc-text">循环语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Handler-函数"><span class="toc-text">Handler 函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#应用调用"><span class="toc-text">应用调用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#终端调用"><span class="toc-text">终端调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Numbers"><span class="toc-text">Numbers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#批量压缩图片"><span class="toc-text">批量压缩图片</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#系统调用"><span class="toc-text">系统调用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#查看界面元素"><span class="toc-text">查看界面元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取前置APP-名称"><span class="toc-text">获取前置APP 名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取前置窗口标题"><span class="toc-text">获取前置窗口标题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#菜单栏鼠标点击"><span class="toc-text">菜单栏鼠标点击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#状态栏图标点击"><span class="toc-text">状态栏图标点击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#提示"><span class="toc-text">提示</span></a></li></ol></li></ol></div></div><div class="post-content"><p><img src="/-media/applescript笔记/image-20190508200937979.png" alt="image-20190508200937979"></p>
<h2 id="常用功能"><a href="#常用功能" class="headerlink" title="常用功能"></a>常用功能</h2><h3 id="激活应用"><a href="#激活应用" class="headerlink" title="激活应用"></a>激活应用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Terminal&quot;</span><br><span class="line">	activate</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h3 id="延时"><a href="#延时" class="headerlink" title="延时"></a>延时</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delay 1 -- 1秒</span><br></pre></td></tr></table></figure>
<h3 id="路径转换"><a href="#路径转换" class="headerlink" title="路径转换"></a>路径转换</h3><h4 id="AppleScript-POSIX路径转换（-与-）"><a href="#AppleScript-POSIX路径转换（-与-）" class="headerlink" title="AppleScript/POSIX路径转换（ : 与 / ）"></a>AppleScript/POSIX路径转换（ : 与 / ）</h4><p><strong>注意：以下代码需在顶层运行，而不是 finder 中。</strong></p>
<p>转换苹果风格(:)为UNIX路径(/)</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> a <span class="keyword">to</span> <span class="string">"Macintosh HD:usr:local:bin:"</span> </span><br><span class="line"><span class="keyword">set</span> p <span class="keyword">to</span> <span class="keyword">POSIX path</span> <span class="keyword">of</span> a</span><br></pre></td></tr></table></figure>
<p>转换UNIX路径(/)为苹果风格(:)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set p to &quot;/usr/local/bin/&quot; </span><br><span class="line">set a to POSIX file p</span><br></pre></td></tr></table></figure>
<p>Alias类型（替身）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set a to alias &quot;Macintosh HD:usr:local:bin:&quot; </span><br><span class="line">set p to POSIX path of a</span><br></pre></td></tr></table></figure>
<p> file类型（链接）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set a to file &quot;Macintosh HD:usr:local:bin:&quot; </span><br><span class="line">set p to POSIX path of a</span><br></pre></td></tr></table></figure>
<h3 id="文本编辑"><a href="#文本编辑" class="headerlink" title="文本编辑"></a>文本编辑</h3><h4 id="文本替换方法"><a href="#文本替换方法" class="headerlink" title="文本替换方法"></a>文本替换方法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">set mdText to replaceText(oldImgName, newImgName, mdText)</span><br><span class="line"></span><br><span class="line">--定义文本替换方法</span><br><span class="line">on replaceText(find, replace, subject)</span><br><span class="line">	set prevTIDs to text item delimiters of AppleScript</span><br><span class="line">	set text item delimiters of AppleScript to find</span><br><span class="line">	set subject to text items of subject</span><br><span class="line">	</span><br><span class="line">	set text item delimiters of AppleScript to replace</span><br><span class="line">	set subject to &quot;&quot; &amp; subject</span><br><span class="line">	set text item delimiters of AppleScript to prevTIDs</span><br><span class="line">	</span><br><span class="line">	return subject</span><br><span class="line">end replaceText</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--未验证</span><br><span class="line">on Replace(repalceString, oldString, newString)</span><br><span class="line">    tell application &quot;System Events&quot;</span><br><span class="line">        set AppleScript&apos;s text item delimiters to oldString</span><br><span class="line">        set aa to every text item of repalceString</span><br><span class="line">        set AppleScript&apos;s text item delimiters to newString</span><br><span class="line">        set bb to aa as string</span><br><span class="line">    end tell</span><br><span class="line">end Replace</span><br></pre></td></tr></table></figure>
<h4 id="获取文件内容"><a href="#获取文件内容" class="headerlink" title="获取文件内容"></a>获取文件内容</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">read alias mdPath as «class utf8»</span><br><span class="line">set mdText to result</span><br></pre></td></tr></table></figure>
<h4 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set qnlistFile to open for access qnlistFile with write permission --打开写入许可</span><br><span class="line">set eof qnlistFile to 0 --内容长度为0，完全覆盖</span><br><span class="line">write qulist to qnlistFile as «class utf8» --写入文件</span><br><span class="line">close access qnlistFile --关闭文件</span><br></pre></td></tr></table></figure>
<h3 id="Finder-调用"><a href="#Finder-调用" class="headerlink" title="Finder 调用"></a>Finder 调用</h3><h4 id="获取文件列表（排除字符）"><a href="#获取文件列表（排除字符）" class="headerlink" title="获取文件列表（排除字符）"></a>获取文件列表（排除字符）</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> folderPath <span class="keyword">to</span> <span class="built_in">alias</span> <span class="string">"Macintosh HD:Users:fwk:Downloads:test:"</span></span><br><span class="line"><span class="keyword">tell</span> <span class="built_in">application</span> <span class="string">"Finder"</span></span><br><span class="line">	<span class="keyword">set</span> imgFile <span class="keyword">to</span> <span class="keyword">every</span> <span class="built_in">file</span> <span class="keyword">of</span> folderPath <span class="keyword">whose</span> <span class="built_in">name</span> <span class="keyword">does</span> <span class="keyword">not</span> <span class="keyword">start with</span> <span class="string">"_"</span></span><br><span class="line">	<span class="keyword">set</span> md <span class="keyword">to</span> <span class="keyword">a reference</span> <span class="keyword">to</span> <span class="built_in">file</span> imgFile</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">tell</span></span><br></pre></td></tr></table></figure>
<h4 id="获取文件扩展名和整个文件名"><a href="#获取文件扩展名和整个文件名" class="headerlink" title="获取文件扩展名和整个文件名"></a>获取文件扩展名和整个文件名</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">tell</span> <span class="built_in">application</span> <span class="string">"Finder"</span></span><br><span class="line">	<span class="keyword">set</span> _extension <span class="keyword">to</span> <span class="built_in">name</span> extension <span class="keyword">of</span> (<span class="built_in">contents</span> <span class="keyword">of</span> i) <span class="comment">--扩展名</span></span><br><span class="line">	<span class="keyword">set</span> _filename <span class="keyword">to</span> <span class="built_in">name</span> <span class="keyword">of</span> (<span class="built_in">contents</span> <span class="keyword">of</span> i) <span class="comment">--文件名+扩展名</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">tell</span></span><br></pre></td></tr></table></figure>
<h4 id="获取文件所在目录的路径"><a href="#获取文件所在目录的路径" class="headerlink" title="获取文件所在目录的路径"></a>获取文件所在目录的路径</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set filePath to alias &quot;Macintosh HD:Users:fwk:Downloads:file.pdf&quot;</span><br><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">	set folderPath to container of filePath as alias</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h4 id="路径拼接"><a href="#路径拼接" class="headerlink" title="路径拼接"></a>路径拼接</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set folderPath to alias &quot;Macintosh HD:Users:fwk:Downloads:&quot;</span><br><span class="line">set f to folderPath as text</span><br><span class="line">set filePath to f &amp; &quot;file.pdf&quot; as alias</span><br></pre></td></tr></table></figure>
<h4 id="文件重命名"><a href="#文件重命名" class="headerlink" title="文件重命名"></a>文件重命名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set mdPath to alias &quot;Macintosh HD:Users:fwk:Downloads:aa.png&quot;  --路径需为 alias 类型</span><br><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">    set name of mdPath to &quot;bb.md&quot; </span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h4 id="文件复制（有同名会替换）"><a href="#文件复制（有同名会替换）" class="headerlink" title="文件复制（有同名会替换）"></a>文件复制（有同名会替换）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--复制并替换，无弹框，需账户密码，不推荐</span><br><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">	do shell script &quot;cp /Users/fwk/a.pdf /Users&quot; user name &quot;fwk&quot; password &quot;f&quot; with administrator privileges</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Finder&quot;</span><br><span class="line"> duplicate file &quot;Macintosh HD:Users:user:Desktop:Test Folder 1:test.doc&quot; to folder &quot;Macintosh HD:Users:user:Desktop:Test Folder 2&quot; with replacing</span><br><span class="line">end tell</span><br><span class="line">--不想替换的去掉with replacing</span><br></pre></td></tr></table></figure>
<h4 id="文件移动"><a href="#文件移动" class="headerlink" title="文件移动"></a>文件移动</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set theFile to (move theFile to desktop) --移动文件并返回移动后的位置</span><br></pre></td></tr></table></figure>
<h4 id="新建文件夹"><a href="#新建文件夹" class="headerlink" title="新建文件夹"></a>新建文件夹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Finder&quot;</span><br><span class="line"> make new folder at alias &quot;Macintosh HD:Users:user:Desktop:&quot; with properties &#123;name:&quot;Test Folder 2&quot;&#125;</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h4 id="复制文件"><a href="#复制文件" class="headerlink" title="复制文件"></a>复制文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">	duplicate file mdPath to imgPath	</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h4 id="复制多个文件"><a href="#复制多个文件" class="headerlink" title="复制多个文件"></a>复制多个文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">repeat with i in imgFile</span><br><span class="line">	duplicate (contents of i) to imgPath</span><br><span class="line">end repeat</span><br></pre></td></tr></table></figure>
<h4 id="打开文件夹"><a href="#打开文件夹" class="headerlink" title="打开文件夹"></a>打开文件夹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Path Finder&quot;</span><br><span class="line">    activate</span><br><span class="line">    open &quot;Macintosh HD:Users:user:Desktop:&quot;</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h4 id="Finder-选中的文件"><a href="#Finder-选中的文件" class="headerlink" title="Finder 选中的文件"></a>Finder 选中的文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">	set itemlist to the selection</span><br><span class="line">	set theFile to item 1 of itemlist</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h3 id="捕捉错误"><a href="#捕捉错误" class="headerlink" title="捕捉错误"></a>捕捉错误</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try</span><br><span class="line">    set x to 1 / 0</span><br><span class="line">on error the error_message number the error_number</span><br><span class="line">    (*</span><br><span class="line">      error_message记录了出错信息，是一个String类型。</span><br><span class="line">      error_number记录了错误代号，是一个number类型。</span><br><span class="line">    *)</span><br><span class="line">    display alert &quot;出错: &quot; &amp; the error_number &amp; &quot;   详细：&quot; &amp; the error_message</span><br><span class="line">end try</span><br></pre></td></tr></table></figure>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 设值 </span><br><span class="line">set someValue to &quot;Apple&quot;</span><br><span class="line">set x to 10</span><br><span class="line"></span><br><span class="line">-- 字符串转整型数字</span><br><span class="line">set x to &quot;10&quot; as number </span><br><span class="line"></span><br><span class="line">-- 取值</span><br><span class="line">get someValue</span><br></pre></td></tr></table></figure>
<h3 id="字符串处理"><a href="#字符串处理" class="headerlink" title="字符串处理"></a>字符串处理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">set str to &quot;hello, world&quot;</span><br><span class="line"></span><br><span class="line">-- 获取字符串长度 </span><br><span class="line">set strLength to the length of &quot;hello&quot; </span><br><span class="line"></span><br><span class="line">-- 截取第一到倒数第2个字符</span><br><span class="line">text 1 thru -2 of str </span><br><span class="line"></span><br><span class="line">-- 取最后一个字符</span><br><span class="line">text -1 of str</span><br><span class="line"></span><br><span class="line">-- 使用 &amp; 连接字符串 </span><br><span class="line">set str to &quot;hello,&quot; &amp; &quot; world&quot; </span><br><span class="line"></span><br><span class="line">-- 使用 \ 来转义 </span><br><span class="line">set str to &quot;\&quot;hello\&quot;&quot; </span><br><span class="line"></span><br><span class="line">-- 整型转字符串 </span><br><span class="line">set str to 10 as string </span><br><span class="line"></span><br><span class="line">-- 把字符串转成字符数组：every character of  </span><br><span class="line">set strList to every character of &quot;String&quot;</span><br><span class="line"></span><br><span class="line">-- 数字转 ASCII码</span><br><span class="line">ASCII character 65</span><br><span class="line">返回：A</span><br><span class="line"></span><br><span class="line">-- ASCII 码转数字</span><br><span class="line">ASCII number &quot;A&quot;</span><br><span class="line">返回：65</span><br><span class="line"></span><br><span class="line">-- 取出一段字符串在另一段字符串的位置</span><br><span class="line">offset of &quot;el&quot; in &quot;hello&quot;</span><br><span class="line">返回：2</span><br><span class="line"></span><br><span class="line">-- 按字符分割字符串 ：AppleScript&apos;s text item delimiters</span><br><span class="line">set defaultDelimiters to AppleScript&apos;s text item delimiters (* 先保存默认字符分割符 *)</span><br><span class="line">set AppleScript&apos;s text item delimiters to &quot;,&quot; (* 使用 AppleScript&apos;s text item delimiters 来指定分割符 *)</span><br><span class="line">set strList to every text item of &quot;1,12,321,cdsa&quot;</span><br><span class="line">set AppleScript&apos;s text item delimiters to defaultDelimiters (* 分割完之后需要还原分割符 *)</span><br><span class="line">get strList</span><br><span class="line"></span><br><span class="line">-- 将数组按照指定分割符组成一段字符串 </span><br><span class="line">set defaultDelimiters to AppleScript&apos;s text item delimiters</span><br><span class="line">set AppleScript&apos;s text item delimiters to &quot;,&quot;</span><br><span class="line">set restoredStr to &#123;&quot;hello&quot;, &quot;world&quot;&#125; as string</span><br><span class="line">set AppleScript&apos;s text item delimiters to defaultDelimiters</span><br><span class="line">get restoredStr</span><br></pre></td></tr></table></figure>
<h4 id="Split方法"><a href="#Split方法" class="headerlink" title="Split方法"></a>Split方法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">on Split(delimiter, splitString)</span><br><span class="line">    tell application &quot;System Events&quot;</span><br><span class="line">        set AppleScript&apos;s text item delimiters to delimiter</span><br><span class="line">        set aa to every text item of splitString</span><br><span class="line">    end tell</span><br><span class="line">end Split</span><br></pre></td></tr></table></figure>
<h4 id="Contain"><a href="#Contain" class="headerlink" title="Contain"></a>Contain</h4><p>判断字符串A是否包含字符串B　　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">return “abc&quot; contain &quot;a&quot;  --return true</span><br></pre></td></tr></table></figure>
<h4 id="list（数组）和-string-转换"><a href="#list（数组）和-string-转换" class="headerlink" title="list（数组）和 string 转换"></a>list（数组）和 string 转换</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set pdfName0 to &quot;1hello.pdf&quot;</span><br><span class="line">set nameList0 to every character of pdfName0	--string分割为数组，</span><br><span class="line">set listLength to the length of nameList0		--获取数组长度</span><br><span class="line">set namelist to items 2 through listLength of nameList0		--去掉首字符</span><br><span class="line">set pdfName to &quot;&quot; &amp; namelist		--数组转换为 string，结果的类型由&amp;运算符之前的变量类型决定</span><br></pre></td></tr></table></figure>
<h3 id="list-数组"><a href="#list-数组" class="headerlink" title="list 数组"></a>list 数组</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">set list1 to &#123;10, &quot;value1&quot;, &quot;value2&quot;&#125;</span><br><span class="line"></span><br><span class="line">-- 获取数组长度：the length of 或 the count of </span><br><span class="line">the length of list1</span><br><span class="line"></span><br><span class="line">-- 使用 &amp; 连接数组 </span><br><span class="line">set list2 to list1 &amp; &#123;&quot;value4&quot;&#125; </span><br><span class="line"></span><br><span class="line">-- 使用 &amp; 连接数组和其他类型变量，&amp; 左边的值的类型决定连接后的值的类型 </span><br><span class="line">get &quot;valueX&quot; &amp; list1</span><br><span class="line"></span><br><span class="line">(* 使用 item index of 获取 list 第 index 个元素，</span><br><span class="line">若 index 为正数则从第一个向后第 index 个元素，</span><br><span class="line">若 index 为负数则从最后一个向前第 index 个元素 *)</span><br><span class="line">item 2 of list2 </span><br><span class="line"></span><br><span class="line">-- 更改数组元素 </span><br><span class="line">set item 2 of list2 to &quot;value3&quot; </span><br><span class="line"></span><br><span class="line">-- 使用 the end of 为数组从末尾添加元素 </span><br><span class="line">set the end of list2 to &quot;value5&quot;</span><br><span class="line"></span><br><span class="line">-- 使用 some item of 来随机获取 list2 中元素 </span><br><span class="line">set randomItem to some item of list2 </span><br><span class="line"></span><br><span class="line">-- 使用 the last item of 获取 list2 最后的元素, 同理可以使用 first、second 等 </span><br><span class="line">set lastItem to the last item of list2</span><br><span class="line"></span><br><span class="line">-- 使用 items begin through end of 获取 list2 的子数组</span><br><span class="line">set shotList to items 2 through 3 of list2</span><br><span class="line"></span><br><span class="line">-- 使用 reverse of 反转数组 </span><br><span class="line">set reverseList to reverse of list2</span><br><span class="line"></span><br><span class="line">-- 将变量转换成数组 </span><br><span class="line">set list3 to &quot;value6&quot; as list</span><br></pre></td></tr></table></figure>
<h3 id="record-字典"><a href="#record-字典" class="headerlink" title="record 字典"></a>record 字典</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">set record1 to &#123;key1: &quot;value1&quot;, key2: &quot;value2&quot;&#125;</span><br><span class="line"></span><br><span class="line">-- 使用 the length/count 获取字典 key/value 対数目</span><br><span class="line">get the count of record1</span><br><span class="line"></span><br><span class="line">-- 使用 the key of record 为字典改变值</span><br><span class="line">set the key1 of record1 to &quot;changedValue&quot;</span><br><span class="line"></span><br><span class="line">-- 使用 the key of record 根据 key 获取字典值</span><br><span class="line">get the key1 of record1</span><br><span class="line"></span><br><span class="line">-- 使用 the items of 获取由字典所有值组成的数组</span><br><span class="line">get the items of record1</span><br></pre></td></tr></table></figure>
<h4 id="record-转-数组"><a href="#record-转-数组" class="headerlink" title="record 转 数组"></a>record 转 数组</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set record1 to &#123;key1:&quot;value1&quot;, key2:&quot;value2&quot;&#125;</span><br><span class="line">copy the result as list to &#123;text_returned, button_pressed&#125;</span><br><span class="line">get text_returned -- 结果value1</span><br></pre></td></tr></table></figure>
<h3 id="日期时间"><a href="#日期时间" class="headerlink" title="日期时间"></a><a href="https://apple.stackexchange.com/questions/144486/applescript-date-manipulation-to-get-multiple-formats" target="_blank" rel="noopener">日期时间</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">set d to do shell script &quot;date &apos;+%Y-%m-%d %H:%M:%S&apos;&quot;  --获取当前时间，如：2018-10-20 12:17:35</span><br><span class="line"></span><br><span class="line">The date formatters are:</span><br><span class="line">%Y 年4位 如：2018</span><br><span class="line">%y 年2位 如：18</span><br><span class="line">%B 月英文全称，如：October</span><br><span class="line">%b 月英文 简称，如：Oct</span><br><span class="line">%m 月2位 如：09</span><br><span class="line">%-m 月无0 如：9</span><br><span class="line">&amp;d 日</span><br><span class="line">%n 换行</span><br><span class="line">%H 时</span><br><span class="line">%M 分</span><br><span class="line">%S 秒</span><br></pre></td></tr></table></figure>
<h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><h3 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h3><h4 id="一般形式"><a href="#一般形式" class="headerlink" title="一般形式"></a>一般形式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if 条件 then  </span><br><span class="line">    ...  </span><br><span class="line">else if 条件 then   </span><br><span class="line">    ...  </span><br><span class="line">else  </span><br><span class="line">    ...  </span><br><span class="line">end if</span><br></pre></td></tr></table></figure>
<h4 id="至简形式"><a href="#至简形式" class="headerlink" title="至简形式"></a>至简形式</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- 都写在一行</span><br><span class="line">if 条件 then ...</span><br></pre></td></tr></table></figure>
<h4 id="数字比较"><a href="#数字比较" class="headerlink" title="数字比较"></a>数字比较</h4><ul>
<li>= 等于</li>
<li>> 大于</li>
<li>&lt; 小于</li>
<li>>= 大于等于</li>
<li>&lt;= 小于等于</li>
<li>/= 不等于</li>
</ul>
<h4 id="字符串比较"><a href="#字符串比较" class="headerlink" title="字符串比较"></a>字符串比较</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">-- str1 是否以 str2 开头</span><br><span class="line">str1 begins with (或者 starts with) str2 </span><br><span class="line"></span><br><span class="line">-- str1 是否不以 str2 开头</span><br><span class="line">str1 does not start with str2 </span><br><span class="line"></span><br><span class="line">-- str2 是否以 str2 结尾</span><br><span class="line">str1 ends with str2</span><br><span class="line"></span><br><span class="line">-- str2 是否不以 str2 结尾</span><br><span class="line">str1 does not end with str2</span><br><span class="line"></span><br><span class="line">-- 是否一致</span><br><span class="line">str1 is equal to str2</span><br><span class="line"></span><br><span class="line">-- str1 是否在 str2 之前</span><br><span class="line">str1 is comes before str2 </span><br><span class="line"></span><br><span class="line">-- str1 是否在 str2 之后</span><br><span class="line">str1 is comes after str2</span><br><span class="line"></span><br><span class="line">-- str1 是否在 str2 里</span><br><span class="line">str1 is in str2</span><br><span class="line"></span><br><span class="line">-- str1 是否不在 str2 里</span><br><span class="line">str1 is not in str2</span><br><span class="line"></span><br><span class="line">-- str1 是否包含 str2</span><br><span class="line">str1 contains str2</span><br><span class="line"></span><br><span class="line">-- str1 是否不包含 str2</span><br><span class="line">str1 does not contain str2</span><br></pre></td></tr></table></figure>
<h3 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-- repeat x times</span><br><span class="line">set num to 0</span><br><span class="line">repeat 3 times</span><br><span class="line">	set num to num + 1</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">-- repeat with 计数变量 from 起始值 to 结束值 by 增长值</span><br><span class="line">-- by 增长值 缺省为1</span><br><span class="line">set num to 0</span><br><span class="line">set startValue to 0</span><br><span class="line">set endValue to 10</span><br><span class="line">set stepValue to 2</span><br><span class="line">repeat with temp from startValue to endValue by stepValue</span><br><span class="line">	set num to num + temp</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">-- repeat while 循环条件</span><br><span class="line">set num to 0</span><br><span class="line">repeat while num /= 10</span><br><span class="line">	set num to num + 1</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">-- repeat until 循环结束条件</span><br><span class="line">set num to 0</span><br><span class="line">repeat until num = 10</span><br><span class="line">	set num to num + 1</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">-- repeat with 单个元素 in 数组</span><br><span class="line">set num to 0</span><br><span class="line">repeat with temp in &#123;1, 2, 3&#125;</span><br><span class="line">	set num to num + temp</span><br><span class="line">end repeat</span><br></pre></td></tr></table></figure>
<h3 id="Handler-函数"><a href="#Handler-函数" class="headerlink" title="Handler 函数"></a>Handler 函数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">-- 带参数和返回值的函数</span><br><span class="line">on charactersOfStr(str)</span><br><span class="line">	return every character of str</span><br><span class="line">end charactersOfStr</span><br><span class="line"></span><br><span class="line">get charactersOfStr(&quot;hello,world&quot;)</span><br><span class="line">-- 如果要在其他应用内调用本文件中的 Handler，要在调用后加 of me 来指定该 Handler 所在文件</span><br><span class="line">on warnFunc()</span><br><span class="line">	display dialog &quot;将要清空废纸篓&quot; buttons &#123;&quot;OK&quot;&#125; default button &quot;OK&quot;</span><br><span class="line">	return button returned of result as string</span><br><span class="line">end warnFunc</span><br><span class="line"></span><br><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">	if warnFunc() of me is equal to &quot;OK&quot; then empty the trash</span><br><span class="line">end tell</span><br><span class="line">-- 调用文件外部的脚本使用 load script</span><br><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">	try</span><br><span class="line">		set scriptPath to choose file</span><br><span class="line">		set warnScript to (load script scriptPath)</span><br><span class="line">		tell warnScript</span><br><span class="line">			</span><br><span class="line">			try</span><br><span class="line">				set resultWarn to warnFunc()</span><br><span class="line">				</span><br><span class="line">				try</span><br><span class="line">					if resultWarn is equal to &quot;OK&quot; then empty the trash</span><br><span class="line">				on error</span><br><span class="line">					display alert &quot;废纸篓没东西&quot;</span><br><span class="line">				end try</span><br><span class="line">				</span><br><span class="line">			on error</span><br><span class="line">				display alert &quot;没有找到该Handler&quot;</span><br><span class="line">			end try</span><br><span class="line">			</span><br><span class="line">		end tell</span><br><span class="line">	on error</span><br><span class="line">		display alert &quot;请选择文件&quot;</span><br><span class="line">	end try</span><br><span class="line">	</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h2 id="应用调用"><a href="#应用调用" class="headerlink" title="应用调用"></a>应用调用</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">--强制退出</span><br><span class="line">tell application &quot;TextEdit&quot; to quit saving no</span><br><span class="line"></span><br><span class="line">--新建文件</span><br><span class="line">tell application &quot;TextEdit&quot;</span><br><span class="line">    make new document</span><br><span class="line">    activate</span><br><span class="line">end tell</span><br><span class="line"></span><br><span class="line">--新建窗口</span><br><span class="line">tell application &quot;Google Chrome&quot;</span><br><span class="line">    make new window</span><br><span class="line">    activate</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h3 id="终端调用"><a href="#终端调用" class="headerlink" title="终端调用"></a>终端调用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Terminal&quot;</span><br><span class="line">	-- 启动当前应用</span><br><span class="line">	activate</span><br><span class="line">	-- 判断当前是否有窗口打开</span><br><span class="line">	if (count of windows) is 0 then</span><br><span class="line">		-- 没有的话，告诉 &quot;System Events&quot; 做好准备</span><br><span class="line">		tell application &quot;System Events&quot;</span><br><span class="line">			-- 模拟按键 Command + N 新建一个窗口</span><br><span class="line">			keystroke &quot;n&quot; using &#123;command down&#125;</span><br><span class="line">		end tell</span><br><span class="line">	else</span><br><span class="line">		activate</span><br><span class="line">	end if</span><br><span class="line">	</span><br><span class="line">	--命令</span><br><span class="line">	do script &quot;qshell batchdelete -force blog-image /Users/fwk/qnlist.txt&quot; in window [0]</span><br><span class="line">	</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<p>路径有空格需在空格前加\，如aa bb，要写成aa\ bb</p>
<p>~/表示用户目录，如~/desktop 展开就是 /users/username/desktop</p>
<p>./source/_posts 相对目录</p>
<h5 id="删除文件夹和文件"><a href="#删除文件夹和文件" class="headerlink" title="删除文件夹和文件"></a>删除文件夹和文件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -r -f 文件夹名</span><br></pre></td></tr></table></figure>
<h3 id="Numbers"><a href="#Numbers" class="headerlink" title="Numbers"></a>Numbers</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Numbers&quot;</span><br><span class="line">  tell table 1 of sheet 3 of document 1</span><br><span class="line">    set the value of cell 1 of column &quot;E&quot; to 1000</span><br><span class="line">  end tell</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h3 id="批量压缩图片"><a href="#批量压缩图片" class="headerlink" title="批量压缩图片"></a>批量压缩图片</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">--获取目录下的所有图片文件</span><br><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">	set imgFile to every file of alias imgPath whose name does not contain &quot;.txt&quot;	</span><br><span class="line">end tell</span><br><span class="line">--压缩图片</span><br><span class="line">tell application &quot;Image Events&quot;</span><br><span class="line">	repeat with i in imgFile</span><br><span class="line">		set img to open file ((contents of i) as text)</span><br><span class="line">		scale img to size 640</span><br><span class="line">		save img</span><br><span class="line">		close img</span><br><span class="line">	end repeat</span><br></pre></td></tr></table></figure>
<h2 id="系统调用"><a href="#系统调用" class="headerlink" title="系统调用"></a>系统调用</h2><h3 id="查看界面元素"><a href="#查看界面元素" class="headerlink" title="查看界面元素"></a>查看界面元素</h3><p>在 Xcode 菜单&gt;Open develop tool &gt; Accessibility Inspector，可查看界面元素的名称</p>
<h3 id="获取前置APP-名称"><a href="#获取前置APP-名称" class="headerlink" title="获取前置APP 名称"></a>获取前置APP 名称</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">	set frontAppProcess to name of first application process whose frontmost is true</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h3 id="获取前置窗口标题"><a href="#获取前置窗口标题" class="headerlink" title="获取前置窗口标题"></a>获取前置窗口标题</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">    set frontAppProcess to first application process whose frontmost is true</span><br><span class="line">    set frontAppName to name of frontAppProcess   </span><br><span class="line">    tell process frontAppName</span><br><span class="line">        if count of windows &gt; 0 then</span><br><span class="line">            set window_name to name of front window</span><br><span class="line">        end if</span><br><span class="line">    end tell</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">    set frontAppProcess to first application process whose frontmost is true</span><br><span class="line">end tell</span><br><span class="line">tell frontAppProcess</span><br><span class="line">    if count of windows &gt; 0 then</span><br><span class="line">       set window_name to name of front window</span><br><span class="line">    end if</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h3 id="菜单栏鼠标点击"><a href="#菜单栏鼠标点击" class="headerlink" title="菜单栏鼠标点击"></a>菜单栏鼠标点击</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;System Events&quot; to tell (process 1 where frontmost is true)</span><br><span class="line">    click menu item &quot;Minimize&quot; of menu 1 of menu bar item &quot;Window&quot; of menu bar 1</span><br><span class="line">end tell</span><br><span class="line"></span><br><span class="line">tell application &quot;System Events&quot; to tell process &quot;Finder&quot;</span><br><span class="line">    set frontmost to true</span><br><span class="line">    tell menu bar item 3 of menu bar 1</span><br><span class="line">        click</span><br><span class="line">        click menu item &quot;Open With&quot; of menu 1</span><br><span class="line">    end tell</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h3 id="状态栏图标点击"><a href="#状态栏图标点击" class="headerlink" title="状态栏图标点击"></a>状态栏图标点击</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">tell</span> <span class="built_in">application</span> <span class="string">"System Events"</span> <span class="keyword">to</span> <span class="keyword">tell</span> process <span class="string">"SystemUIServer"</span></span><br><span class="line">    <span class="keyword">set</span> wifi_menu <span class="keyword">to</span> (<span class="keyword">first</span> menu bar <span class="built_in">item</span> <span class="keyword">whose</span> description <span class="keyword">contains</span> <span class="string">"Wi-Fi"</span>) <span class="keyword">of</span> menu bar <span class="number">1</span></span><br><span class="line">    <span class="keyword">tell</span> wifi_menu</span><br><span class="line">        click</span><br><span class="line">        click menu <span class="built_in">item</span> <span class="string">"关闭 Wi-Fi"</span> <span class="keyword">of</span> menu <span class="number">1</span>       </span><br><span class="line">    <span class="keyword">end</span> <span class="keyword">tell</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">tell</span></span><br></pre></td></tr></table></figure>
<h4 id="触发按键"><a href="#触发按键" class="headerlink" title="触发按键"></a>触发按键</h4><h5 id="keystroke"><a href="#keystroke" class="headerlink" title="keystroke"></a>keystroke</h5><p>主要用于字符输入，输入的是字符的对应按键，因此会受输入法影响；比如“!”在中文输入法下会变成“！”</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">tell</span> <span class="built_in">application</span> <span class="string">"System Events"</span></span><br><span class="line">    keystroke <span class="string">"v"</span> using &#123;command down, option down&#125;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">tell</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动TextEdit并输入标准的“Hello world！”</span></span><br><span class="line"><span class="keyword">tell</span> <span class="built_in">application</span> <span class="string">"System Events"</span></span><br><span class="line">  <span class="built_in">delay</span> <span class="number">0.5</span></span><br><span class="line">  keystroke <span class="literal">space</span> using command down</span><br><span class="line">  <span class="built_in">delay</span> <span class="number">0.5</span></span><br><span class="line">  keystroke <span class="string">"Text"</span></span><br><span class="line">  <span class="built_in">delay</span> <span class="number">0.5</span></span><br><span class="line">  keystroke <span class="string">"Edit"</span></span><br><span class="line">  <span class="built_in">delay</span> <span class="number">0.5</span></span><br><span class="line">  keystroke <span class="literal">return</span></span><br><span class="line">  <span class="built_in">delay</span> <span class="number">1</span></span><br><span class="line">  keystroke <span class="string">"Hello world!"</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">tell</span></span><br></pre></td></tr></table></figure>
<p>部分键也能使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">keystroke return</span><br><span class="line">keystroke space</span><br><span class="line">keystroke tab</span><br></pre></td></tr></table></figure>
<h6 id="keycode："><a href="#keycode：" class="headerlink" title="keycode："></a>keycode：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;System Events&quot;</span><br><span class="line">    key code 53 using &#123;command down, option down&#125;</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<p><img src="/-media/applescript笔记/image-20190305170639458.png" alt="image-20190305170639458"></p>
<p>0 0x00 ANSI_A<br>1 0x01 ANSI_S<br>2 0x02 ANSI_D<br>3 0x03 ANSI_F<br>4 0x04 ANSI_H<br>5 0x05 ANSI_G<br>6 0x06 ANSI_Z<br>7 0x07 ANSI_X<br>8 0x08 ANSI_C<br>9 0x09 ANSI_V<br>10 0x0A ISO_Section<br>11 0x0B ANSI_B<br>12 0x0C ANSI_Q<br>13 0x0D ANSI_W<br>14 0x0E ANSI_E<br>15 0x0F ANSI_R<br>16 0x10 ANSI_Y<br>17 0x11 ANSI_T<br>18 0x12 ANSI_1<br>19 0x13 ANSI_2<br>20 0x14 ANSI_3<br>21 0x15 ANSI_4<br>22 0x16 ANSI_6<br>23 0x17 ANSI_5<br>24 0x18 ANSI_Equal<br>25 0x19 ANSI_9<br>26 0x1A ANSI_7<br>27 0x1B ANSI_Minus<br>28 0x1C ANSI_8<br>29 0x1D ANSI_0<br>30 0x1E ANSI_RightBracket<br>31 0x1F ANSI_O<br>32 0x20 ANSI_U<br>33 0x21 ANSI_LeftBracket<br>34 0x22 ANSI_I<br>35 0x23 ANSI_P<br>36 0x24 Return<br>37 0x25 ANSI_L<br>38 0x26 ANSI_J<br>39 0x27 ANSI_Quote<br>40 0x28 ANSI_K<br>41 0x29 ANSI_Semicolon<br>42 0x2A ANSI_Backslash<br>43 0x2B ANSI_Comma<br>44 0x2C ANSI_Slash<br>45 0x2D ANSI_N<br>46 0x2E ANSI_M<br>47 0x2F ANSI_Period<br>48 0x30 Tab<br>49 0x31 Space<br>50 0x32 ANSI_Grave<br>51 0x33 Delete<br>53 0x35 Escape<br>55 0x37 Command<br>56 0x38 Shift<br>57 0x39 CapsLock<br>58 0x3A Option<br>59 0x3B Control<br>60 0x3C RightShift<br>61 0x3D RightOption<br>62 0x3E RightControl<br>63 0x3F Function<br>64 0x40 F17<br>65 0x41 ANSI_KeypadDecimal<br>67 0x43 ANSI_KeypadMultiply<br>69 0x45 ANSI_KeypadPlus<br>71 0x47 ANSI_KeypadClear<br>72 0x48 VolumeUp<br>73 0x49 VolumeDown<br>74 0x4A Mute<br>75 0x4B ANSI_KeypadDivide<br>76 0x4C ANSI_KeypadEnter<br>78 0x4E ANSI_KeypadMinus<br>79 0x4F F18<br>80 0x50 F19<br>81 0x51 ANSI_KeypadEquals<br>82 0x52 ANSI_Keypad0<br>83 0x53 ANSI_Keypad1<br>84 0x54 ANSI_Keypad2<br>85 0x55 ANSI_Keypad3<br>86 0x56 ANSI_Keypad4<br>87 0x57 ANSI_Keypad5<br>88 0x58 ANSI_Keypad6<br>89 0x59 ANSI_Keypad7<br>90 0x5A F20<br>91 0x5B ANSI_Keypad8<br>92 0x5C ANSI_Keypad9<br>93 0x5D JIS_Yen<br>94 0x5E JIS_Underscore<br>95 0x5F JIS_KeypadComma<br>96 0x60 F5<br>97 0x61 F6<br>98 0x62 F7<br>99 0x63 F3<br>100 0x64 F8<br>101 0x65 F9<br>102 0x66 JIS_Eisu<br>103 0x67 F11<br>104 0x68 JIS_Kana<br>105 0x69 F13<br>106 0x6A F16<br>107 0x6B F14<br>109 0x6D F10<br>111 0x6F F12<br>113 0x71 F15<br>114 0x72 Help<br>115 0x73 Home<br>116 0x74 PageUp<br>117 0x75 ForwardDelete<br>118 0x76 F4<br>119 0x77 End<br>120 0x78 F2<br>121 0x79 PageDown<br>122 0x7A F1<br>123 0x7B LeftArrow<br>124 0x7C RightArrow<br>125 0x7D DownArrow<br>126 0x7E UpArrow</p>
<h4 id="剪贴板"><a href="#剪贴板" class="headerlink" title="剪贴板"></a>剪贴板</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set the clipboard to &quot;hello&quot;</span><br><span class="line">set oldData to (get the clipboard as text)</span><br><span class="line"></span><br><span class="line">set theData to (the clipboard as text) --输出结果相同，但数据不相等，猜测是clipboard对象</span><br></pre></td></tr></table></figure>
<h3 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">display alert &quot;This is an alert&quot; buttons &#123;&quot;No&quot;, &quot;Yes&quot;&#125;</span><br><span class="line">if button returned of result = &quot;No&quot; then</span><br><span class="line">     display alert &quot;No was clicked&quot;</span><br><span class="line">else</span><br><span class="line">    if button returned of result = &quot;Yes&quot; then</span><br><span class="line">         display alert &quot;Yes was clicked&quot;</span><br><span class="line">    end if</span><br><span class="line">end if</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">display notification &quot;已存在图片目录&quot;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">display notification &quot; 通知内容&quot;</span><br></pre></td></tr></table></figure>
<p>参考：<a href="http://mkapple.cn/2016/07/21/AppleScriptStart" target="_blank" rel="noopener">Apple Script 从入门到放弃</a></p>
</div><div class="tags"><a href="/tags/applescript/">applescript</a></div><div class="post-nav"><a class="pre" href="/2017/12/01/hexo 主题定义笔记/">Hexo博客主题定制笔记</a><a class="next" href="/2017/09/17/从橡皮擦的纸套设计看产品思维/">从橡皮擦的纸套设计看产品思维</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://yodu.xyz"></form></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">有度.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></div></div></div><a id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>