<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="探寻设计的尺度"><title>Electron 学习笔记 | 有度</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="header-limit"><div class="site-name"><h1 class="hidden">Electron 学习笔记</h1><a class="logo-brand" href="/." rel="home"><img class="logo nofancybox" src="/img/logo.svg" alt="yodu"></a></div><div id="nav-menu"><a href="/."><i class="fa null"> 首页</i></a><a href="/categories/设计/"><i class="fa null"> 设计</i></a><a href="/categories/编程/"><i class="fa null"> 编程</i></a><a href="/categories/随笔/"><i class="fa null"> 随笔</i></a><a href="/about/"><i class="fa null"> 关于</i></a></div></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Electron 学习笔记</h1><div class="post-meta">2017-12-23<span class="category"><a href="/categories/编程/">编程</a></span></div><div class="clear"><div class="toc-article" id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#开发基础"><span class="toc-text">开发基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#安装"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运行应用"><span class="toc-text">运行应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#主进程调试"><span class="toc-text">主进程调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#渲染进程调试"><span class="toc-text">渲染进程调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#REPL"><span class="toc-text">REPL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#打包"><span class="toc-text">打包</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#架构"><span class="toc-text">架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#进程间通讯"><span class="toc-text">进程间通讯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#全局变量"><span class="toc-text">全局变量</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常用API"><span class="toc-text">常用API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#剪贴板-☍"><span class="toc-text">剪贴板 ☍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通知"><span class="toc-text">通知</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dock-显示"><span class="toc-text">Dock 显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shell"><span class="toc-text">shell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#菜单-menu"><span class="toc-text">菜单 menu</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#库"><span class="toc-text">库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fs-extra"><span class="toc-text">fs-extra</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#调用applescript"><span class="toc-text">调用applescript</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取活动窗口信息"><span class="toc-text">获取活动窗口信息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#版本管理"><span class="toc-text">版本管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#更新electron"><span class="toc-text">更新electron</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#更新-node-版本"><span class="toc-text">更新 node 版本</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常见坑"><span class="toc-text">常见坑</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#复制粘贴用不了"><span class="toc-text">复制粘贴用不了</span></a></li></ol></li></ol></div></div><div class="post-content"><p><img src="/-media/Electron笔记/image-20190504104413739.png" alt="image-20190504104413739"></p>
<p>Electron 是一个使用Web 前端技术创建原生程序的框架，可以同时在macOS、windows、linux上运行，并轻松实现原生程序的体验。</p>
<h2 id="开发基础"><a href="#开发基础" class="headerlink" title="开发基础"></a>开发基础</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ol>
<li><p>安装 <a href="https://link.jianshu.com/?t=https://nodejs.org/en/download/" target="_blank" rel="noopener">node.js 和npm</a></p>
</li>
<li><p>全局安装electron</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g electron</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装打包工具 electron-packager</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g electron-packager</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="运行应用"><a href="#运行应用" class="headerlink" title="运行应用"></a>运行应用</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装依赖库</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> npm install</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 运行应用</span></span><br><span class="line">npm start</span><br></pre></td></tr></table></figure>
<h3 id="主进程调试"><a href="#主进程调试" class="headerlink" title="主进程调试"></a>主进程调试</h3><p>主进程是基于Node.js的，所以调试和Node.js类似，可在VS Code中进行调试：</p>
<p>第一步，设置VS Code的tasks，用于启动electron。相关配置如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  // See https://go.microsoft.com/fwlink/?LinkId=733558</span><br><span class="line">  // for the documentation about the tasks.json format</span><br><span class="line">  &quot;version&quot;: &quot;0.1.0&quot;,</span><br><span class="line">  &quot;command&quot;: &quot;electron&quot;,</span><br><span class="line">  &quot;isShellCommand&quot;: true,</span><br><span class="line">  &quot;showOutput&quot;: &quot;always&quot;,</span><br><span class="line">  &quot;suppressTaskName&quot;: true,</span><br><span class="line">  &quot;args&quot;: [&quot;--debug=5858&quot;, &quot;.&quot;] </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中，<code>--debug=5858</code>是用于调试Node.js的端口。</p>
<p>第二步，设置VS Code项目的调试配置。可以生成launch.json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;version&quot;: &quot;0.2.0&quot;,</span><br><span class="line">  &quot;configurations&quot;: [ &#123;</span><br><span class="line">      &quot;name&quot;: &quot;Attach&quot;,</span><br><span class="line">      &quot;type&quot;: &quot;node&quot;,</span><br><span class="line">      &quot;address&quot;: &quot;localhost&quot;,</span><br><span class="line">      &quot;port&quot;: 5858,</span><br><span class="line">      &quot;request&quot;: &quot;attach&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中的<code>port:5858</code>需要和上面的<code>--debug=5858</code>端口保持一致。  </p>
<p>开始调试主进程。  </p>
<p>首先启动electron项目。</p>
<p> 按下快捷键<code>shift + command + p</code>可以启动命令，输入<code>task electron</code>命令运行<code>electron</code>的task进行项目的启动。  </p>
<p>项目启动后，再开始设置主进程代码的断点。在VS Code的调试界面中设置断点，并点击运行。这个时候，操作启动的electron应用，当运行到断点所在代码时，就可以触发断点调试。</p>
<h4 id="electron-vue的调试"><a href="#electron-vue的调试" class="headerlink" title="electron-vue的调试"></a>electron-vue的调试</h4><p>由于要使用webpack和babel，以支持ES6，所以需要代码转换相关的配置，具体配置如下：</p>
<p>launch.js中配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"version"</span>: <span class="string">"0.2.0"</span>,</span><br><span class="line">    <span class="string">"configurations"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">"调试"</span>,</span><br><span class="line">            <span class="string">"type"</span>: <span class="string">"node"</span>,</span><br><span class="line">            <span class="string">"request"</span>: <span class="string">"launch"</span>,</span><br><span class="line">            <span class="string">"program"</span>: <span class="string">"$&#123;workspaceRoot&#125;/src/main/index.dev.js"</span>,</span><br><span class="line">            <span class="string">"env"</span>: &#123;</span><br><span class="line">                <span class="string">"DEBUG_ENV"</span>: <span class="string">"debug"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"stopOnEntry"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"args"</span>: [],</span><br><span class="line">            <span class="string">"cwd"</span>: <span class="string">"$&#123;workspaceRoot&#125;"</span>,</span><br><span class="line">                            <span class="comment">// this points to the electron task runner</span></span><br><span class="line">            <span class="string">"runtimeExecutable"</span>: <span class="string">"$&#123;workspaceRoot&#125;/node_modules/.bin/electron"</span>,</span><br><span class="line">            <span class="string">"runtimeArgs"</span>: [</span><br><span class="line">                <span class="string">"--nolazy"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="string">"console"</span>: <span class="string">"integratedTerminal"</span>,</span><br><span class="line">            <span class="string">"sourceMaps"</span>: <span class="literal">true</span></span><br><span class="line">        &#125; </span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.dev.js配置调试环境和 ES6代码转换；</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">process.env.NODE_ENV = <span class="string">'development'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Install `electron-debug` with `devtron`</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'electron-debug'</span>)(&#123; <span class="attr">showDevTools</span>: <span class="literal">false</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Install `vue-devtools`</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'electron'</span>).app.on(<span class="string">'ready'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> installExtension = <span class="built_in">require</span>(<span class="string">'electron-devtools-installer'</span>)</span><br><span class="line">  installExtension.default(installExtension.VUEJS_DEVTOOLS)</span><br><span class="line">    .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Unable to install `vue-devtools`: \n'</span>, err)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Require `main` process to boot app</span></span><br><span class="line"><span class="keyword">if</span> (process.env.DEBUG_ENV === <span class="string">'debug'</span>) &#123;</span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'babel-core/register'</span>)(&#123; <span class="comment">//es6 转换</span></span><br><span class="line">    <span class="string">'presets'</span>: [</span><br><span class="line">      [<span class="string">'env'</span>, &#123;</span><br><span class="line">        <span class="string">'targets'</span>: &#123;</span><br><span class="line">          <span class="string">'node'</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;]</span><br><span class="line">    ]</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Require `main` process to boot app</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">'./index'</span>)</span><br></pre></td></tr></table></figure>
<p>再实际使用中存在断点位置跳动的问题，暂无解决办法。</p>
<h3 id="渲染进程调试"><a href="#渲染进程调试" class="headerlink" title="渲染进程调试"></a>渲染进程调试</h3><p>在main.js中，在createWindow中，通过添加以下接口打开DevTools，进行页面调试，调试方法和使用Chrome进行调试一致。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> //渲染进程调试 Open the DevTools.</span><br><span class="line">function createWindow() &#123;</span><br><span class="line">  mainWindow.webContents.openDevTools()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="REPL"><a href="#REPL" class="headerlink" title="REPL"></a>REPL</h3><p>读取(Read)-运算(Eval)-输出(Print)-循环(Loop) (REPL) 是很简单的, 交互式的计算机编程环境</p>
<p>如果你的 <code>electron</code> 或 <code>electron-prebuilt</code> 已经安装为本地项目依赖项，在终端执行:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./node_modules/.bin/electron --interactive</span><br></pre></td></tr></table></figure>
<h3 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h3><p>安装 electron-builder</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add electron-builder --dev</span><br></pre></td></tr></table></figure>
<p>执行构建，<a href="https://www.electron.build/cli" target="_blank" rel="noopener">更多命令</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">electron-builder --mac</span><br></pre></td></tr></table></figure>
<p>配置package.json</p>
<p>devDependencies为开发环境依赖，dependencies生产环境依赖（用户使用）</p>
<p><code>--save</code> 将依赖的名称、版本要求添加到 dependencies</p>
<p><code>--save-dev</code> 将依赖的名称、版本要求添加到 devDependencies</p>
<h4 id="开发环境用户目录"><a href="#开发环境用户目录" class="headerlink" title="开发环境用户目录"></a>开发环境用户目录</h4><p>/Users/fwk/Library/Application Support/Electron</p>
<h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><p>Electron 由main进程和renderer进程构成，main进程主要控制原生系统APP相关的功能，主要包括App的整个生命周期和原生界面的调用，如窗口创建，菜单栏，任务栏托盘等等，renderer进程等同与浏览器中的web页面，一般前端能用的东西都能在这里使用，另外Electron还提供了node.js和原生系统功能的支持，详见下图（图片来自<a href="https://molunerfinn.com/electron-vue-2/#BrowserWindow" target="_blank" rel="noopener">Molunerfinn 博客</a>，有详细的介绍）</p>
<p><img src="/-media/Electron笔记/8700af19ly1fnhcn82n7sj21wu1fmn6v.png" alt="main &amp; renderer process tree"></p>
<p>要注意的是在renderer中不能require 引入 main.js，而各个renderer之间可以相互require；</p>
<h3 id="进程间通讯"><a href="#进程间通讯" class="headerlink" title="进程间通讯"></a>进程间通讯</h3><h5 id="ipcMain、ipcRenderer"><a href="#ipcMain、ipcRenderer" class="headerlink" title="ipcMain、ipcRenderer"></a>ipcMain、ipcRenderer</h5><p>main和renderer进程之间通过消息通讯，并在收到消息时执行回调函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main端 选择要替换的目录</span></span><br><span class="line">ipcMain.on(<span class="string">'open-file-dialog'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span><br><span class="line">  dialog.showOpenDialog(&#123;</span><br><span class="line">    properties: [<span class="string">'openFile'</span>, <span class="string">'openDirectory'</span>]</span><br><span class="line">  &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">files</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (files) event.sender.send(<span class="string">'selected-directory'</span>, files)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// renderer端 </span></span><br><span class="line">selectDirBtn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;	<span class="comment">// 触发打开对话框</span></span><br><span class="line">  ipcRenderer.send(<span class="string">'open-file-dialog'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">ipcRenderer.on(<span class="string">'selected-directory'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event, path</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'selectDirInput'</span>).value = path  <span class="comment">// 赋值并显示所选路径</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h5><p>可以调用主进程对象的方法，而无需显式地发送进程间消息</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 渲染进程，通过 remote 调用主进程中 BrowserWindow 来创建应用窗口：</span></span><br><span class="line"><span class="keyword">const</span> remote = <span class="built_in">require</span>(<span class="string">'electron'</span>).remote;</span><br><span class="line"><span class="keyword">const</span> BrowserWindow = remote.BrowserWindow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> win = <span class="keyword">new</span> BrowserWindow(&#123; <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">height</span>: <span class="number">100</span> &#125;);</span><br><span class="line">win.loadURL(<span class="string">'http://www.jartto.wang'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h3><p><a href="http://electron.rocks/sharing-between-main-and-renderer-process/" target="_blank" rel="noopener">http://electron.rocks/sharing-between-main-and-renderer-process/</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main端</span></span><br><span class="line"><span class="comment">// 变量</span></span><br><span class="line">global.mdPath = <span class="string">''</span></span><br><span class="line">mdPath = <span class="string">'/Users/fwk/Library/Mobile Documents/iCloud~com~coderforart~iOS~MWeb/Documents/·MD笔记'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象</span></span><br><span class="line">global.sharedObject = &#123;</span><br><span class="line">  someProperty: <span class="string">'default value'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// renderer端</span></span><br><span class="line"><span class="keyword">const</span> &#123; remote &#125; = <span class="built_in">require</span>(<span class="string">'electron'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(remote.getGlobal(<span class="string">'mdPath'</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main端</span></span><br><span class="line">global.something = value;</span><br><span class="line"></span><br><span class="line"><span class="comment">// renderer端</span></span><br><span class="line"><span class="keyword">const</span> remote = <span class="built_in">require</span>(<span class="string">'electron'</span>).remote;</span><br><span class="line"><span class="keyword">var</span> something = remote.getGlobal(<span class="string">'something'</span>);</span><br></pre></td></tr></table></figure>
<h2 id="常用API"><a href="#常用API" class="headerlink" title="常用API"></a>常用API</h2><h3 id="剪贴板-☍"><a href="#剪贴板-☍" class="headerlink" title="剪贴板 ☍"></a>剪贴板 <a href="https://electronjs.org/docs/api/clipboard#clipboardreadtexttype" target="_blank" rel="noopener">☍</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">clipboard.writeText(&apos;Example String&apos;) </span><br><span class="line">clipboard.readText()</span><br></pre></td></tr></table></figure>
<h3 id="通知"><a href="#通知" class="headerlink" title="通知"></a>通知</h3><h5 id="主进程通知"><a href="#主进程通知" class="headerlink" title="主进程通知"></a><a href="https://github.com/electron/electron/pull/9269" target="_blank" rel="noopener">主进程通知</a></h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;Notification&#125; = <span class="built_in">require</span>(<span class="string">'electron'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> notification = <span class="keyword">new</span> Notification(&#123;</span><br><span class="line">  title: <span class="string">`已存在图片目录“<span class="subst">$&#123;title&#125;</span>”`</span>,</span><br><span class="line">  body: <span class="string">'描述'</span>,</span><br><span class="line">  silent: <span class="literal">true</span>,</span><br><span class="line">  icon: <span class="string">'/path/to/icon.png'</span></span><br><span class="line">  hasReply: <span class="literal">true</span>,</span><br><span class="line">  replyPlaceholder: <span class="string">'Type Here!!'</span></span><br><span class="line">&#125;)</span><br><span class="line">notification.on(<span class="string">'show'</span>, () =&gt; <span class="built_in">console</span>.log(<span class="string">'showed'</span>));</span><br><span class="line">notification.on(<span class="string">'click'</span>, () =&gt; <span class="built_in">console</span>.info(<span class="string">'clicked!!'</span>));</span><br><span class="line">notification.on(<span class="string">'reply'</span>, (e, reply) =&gt; <span class="built_in">console</span>.log(<span class="string">'Replied:'</span>, reply));</span><br><span class="line"></span><br><span class="line">notification.show()</span><br></pre></td></tr></table></figure>
<h5 id="渲染进程通知"><a href="#渲染进程通知" class="headerlink" title="渲染进程通知"></a><a href="https://electronjs.org/docs/tutorial/notifications" target="_blank" rel="noopener">渲染进程通知</a></h5><p>这是一个 HTML5 API，只能在渲染器进程中使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> myNotification = <span class="keyword">new</span> Notification(<span class="string">'标题'</span>, &#123;</span><br><span class="line">  body: <span class="string">'通知正文内容'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">myNotification.onclick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'通知被点击'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Dock-显示"><a href="#Dock-显示" class="headerlink" title="Dock 显示"></a>Dock 显示</h3><p>在 <code>OS X</code> 中 <code>Dock</code> 默认会被打开，我们还可以在主进程中做一些额外的控制，如隐藏、设置菜单等操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.dock.hide();</span><br><span class="line">app.dock.setMenu(menu);</span><br></pre></td></tr></table></figure>
<h3 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h3><p>使用默认程序处理文件或链接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const &#123;shell&#125; = require(&apos;electron&apos;)</span><br><span class="line">shell.openExternal(&apos;https://github.com&apos;)</span><br><span class="line">shell.showItemInFolder(fullPath)</span><br></pre></td></tr></table></figure>
<h3 id="菜单-menu"><a href="#菜单-menu" class="headerlink" title="菜单 menu"></a>菜单 menu</h3><h4 id="右键菜单"><a href="#右键菜单" class="headerlink" title="右键菜单"></a>右键菜单</h4><h5 id="渲染进程"><a href="#渲染进程" class="headerlink" title="渲染进程"></a>渲染进程</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//vue</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">const</span> Electron = <span class="built_in">require</span>(<span class="string">'electron'</span>)</span><br><span class="line"><span class="keyword">const</span> remote = Electron.remote</span><br><span class="line"><span class="keyword">const</span> &#123; Menu, MenuItem &#125; = remote</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  methods: &#123;</span><br><span class="line">    contextMenu(event, data, node) &#123;</span><br><span class="line">      <span class="keyword">this</span>.$refs.tree.setCurrentKey(data.id)</span><br><span class="line">      <span class="keyword">this</span>.currentChange(data, node)</span><br><span class="line">      <span class="keyword">let</span> that = <span class="keyword">this</span></span><br><span class="line">      <span class="keyword">const</span> template = [</span><br><span class="line">        &#123;</span><br><span class="line">          label: <span class="string">'重命名'</span>,</span><br><span class="line">          click() &#123;</span><br><span class="line">            that.editName(node, data)</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          label: <span class="string">'删除'</span>,</span><br><span class="line">          click() &#123;</span><br><span class="line">            that.delCtag(node, data)</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          label: <span class="string">'新建标签'</span>,</span><br><span class="line">          click() &#123;</span><br><span class="line">            that.addCtag(node, data)</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      ]</span><br><span class="line">      <span class="keyword">const</span> menu = Menu.buildFromTemplate(template)</span><br><span class="line">      menu.popup(remote.getCurrentWindow())</span><br><span class="line">    &#125;,</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// html实现</span></span><br><span class="line"><span class="keyword">const</span> &#123;remote&#125; = <span class="built_in">require</span>(<span class="string">'electron'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;Menu, MenuItem&#125; = remote;</span><br><span class="line"></span><br><span class="line"><span class="comment">//右键餐单</span></span><br><span class="line"><span class="keyword">const</span> menu = <span class="keyword">new</span> Menu();</span><br><span class="line">menu.append(<span class="keyword">new</span> MenuItem(&#123;</span><br><span class="line">    label: <span class="string">'放大'</span>,</span><br><span class="line">    click:<span class="function"><span class="keyword">function</span> (<span class="params"></span>)  </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'item 1 clicked'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;));</span><br><span class="line">menu.append(<span class="keyword">new</span> MenuItem(&#123;<span class="attr">type</span>: <span class="string">'separator'</span>&#125;));<span class="comment">//分割线</span></span><br><span class="line">menu.append(<span class="keyword">new</span> MenuItem(&#123;<span class="attr">label</span>: <span class="string">'缩小'</span>, <span class="attr">type</span>: <span class="string">'checkbox'</span>, <span class="attr">checked</span>: <span class="literal">true</span>&#125;));<span class="comment">//选中</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'contextmenu'</span>, (e) =&gt; &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    menu.popup(&#123;<span class="attr">window</span>: remote.getCurrentWindow()&#125;)</span><br><span class="line">&#125;, <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<h2 id="库"><a href="#库" class="headerlink" title="库"></a>库</h2><h3 id="fs-extra"><a href="#fs-extra" class="headerlink" title="fs-extra"></a>fs-extra</h3><p>选择文件夹并获取文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">'fs-extra'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法一 回调地狱</span></span><br><span class="line"><span class="keyword">let</span> dirFile = []</span><br><span class="line">dialog.showOpenDialog(&#123;</span><br><span class="line">  properties: [<span class="string">'openDirectory'</span>]</span><br><span class="line">&#125;, (files) =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(files[<span class="number">0</span>])</span><br><span class="line">  fs.readdir(files[<span class="number">0</span>], (err, files) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123; </span><br><span class="line">      <span class="built_in">console</span>.log(err) </span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    dirFile = files.filter(<span class="function"><span class="params">item</span> =&gt;</span> !(<span class="regexp">/(^|\/)\.[^/.]/g</span>).test(item))</span><br><span class="line">    <span class="built_in">console</span>.log(dirFile)</span><br><span class="line">  &#125;) </span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法二 Promise链式调用 (推荐)</span></span><br><span class="line"><span class="keyword">let</span> files = dialog.showOpenDialog(&#123;<span class="attr">properties</span>: [<span class="string">'openDirectory'</span>]&#125;) <span class="comment">//返回数组</span></span><br><span class="line">fs.readdir(files[<span class="number">0</span>])		<span class="comment">//返回Promise对象</span></span><br><span class="line">  .then(<span class="function"><span class="params">files</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(files)</span><br><span class="line">    <span class="keyword">return</span> files.filter(<span class="function"><span class="params">item</span> =&gt;</span> !(<span class="regexp">/(^|\/)\.[^/.]/g</span>).test(item))</span><br><span class="line">	&#125;)</span><br><span class="line">  .then(<span class="function"><span class="params">value</span> =&gt;</span> <span class="built_in">console</span>.log(value))</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.error(err))</span><br></pre></td></tr></table></figure>
<h3 id="调用applescript"><a href="#调用applescript" class="headerlink" title="调用applescript"></a>调用applescript</h3><p>使用<a href="https://www.npmjs.com/package/node-osascript" target="_blank" rel="noopener">node-osascript</a> ，终端执行安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install node-osascript</span><br></pre></td></tr></table></figure>
<p>1.执行applescript语句：’ ‘内为applescript语句，换行用\n分隔，也可用<code></code>直接换行写，后面接回调函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> osascript = <span class="built_in">require</span>(<span class="string">'node-osascript'</span>)</span><br><span class="line">osascript.execute(<span class="string">'display dialog theDialogText buttons &#123;"按键1", "按键2", "按键3"&#125;\nset DlogResult to result\n return result'</span>, &#123; <span class="attr">theDialogText</span> : <span class="string">'要传递的变量内容'</span>&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">err, result, raw</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err)</span><br><span class="line">  <span class="built_in">console</span>.log(result, raw)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>2.执行脚本文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">osascript.executeFile(<span class="string">'path/to/script.scpt'</span>, &#123; <span class="attr">varName</span> : <span class="string">'value'</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err, result, raw</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="built_in">console</span>.error(err)</span><br><span class="line">    <span class="built_in">console</span>.log(result, raw)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>注意：延时delay只对applescript有效，osascript在js中为异步执行。</p>
<h3 id="获取活动窗口信息"><a href="#获取活动窗口信息" class="headerlink" title="获取活动窗口信息"></a>获取活动窗口信息</h3><h5 id="active-win"><a href="#active-win" class="headerlink" title="active-win"></a><a href="https://github.com/sindresorhus/active-win" target="_blank" rel="noopener">active-win</a></h5><p>Works on macOS, Linux, Windows.</p>
<p>Get metadata about the active window (title, id, bounds, owner, etc)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> activeWin = <span class="built_in">require</span>(<span class="string">'active-win'</span>)</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="keyword">await</span> activeWin())</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		title: 'Unicorns - Google Search',</span></span><br><span class="line"><span class="comment">		id: 5762,</span></span><br><span class="line"><span class="comment">		bounds: &#123;</span></span><br><span class="line"><span class="comment">			x: 0,</span></span><br><span class="line"><span class="comment">			y: 0,</span></span><br><span class="line"><span class="comment">			height: 900,</span></span><br><span class="line"><span class="comment">			width: 1440</span></span><br><span class="line"><span class="comment">		&#125;,</span></span><br><span class="line"><span class="comment">		owner: &#123;</span></span><br><span class="line"><span class="comment">			name: 'Google Chrome',</span></span><br><span class="line"><span class="comment">			processId: 310,</span></span><br><span class="line"><span class="comment">			bundleId: 'com.google.Chrome',</span></span><br><span class="line"><span class="comment">			path: '/Applications/Google Chrome.app'</span></span><br><span class="line"><span class="comment">		&#125;,</span></span><br><span class="line"><span class="comment">		memoryUsage: 11015432</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<h5 id="node-ffi"><a href="#node-ffi" class="headerlink" title="node-ffi"></a><a href="https://github.com/node-ffi/node-ffi" target="_blank" rel="noopener">node-ffi</a></h5><p><code>node-ffi</code> provides a powerful set of tools for interfacing with dynamic libraries using pure JavaScript in the Node.js environment. </p>
<p>I like this approach the best because it’s the most direct access from JavaScript to the native APIs. If you were going for multiple platforms, a package like active-win above might be best, but for just a few small accesses, using node-ffi to hook into native functions seems the cleanest to me. (and more future proof, since there’s no library you need to understand in order to update it if it has an issue)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import ffi from &quot;ffi&quot;;</span><br><span class="line">import ref from &quot;ref&quot;;</span><br><span class="line"></span><br><span class="line">declare var Buffer;</span><br><span class="line"></span><br><span class="line">var user32 = new ffi.Library(&quot;user32&quot;, &#123;</span><br><span class="line">   &quot;GetForegroundWindow&quot;: [&quot;int32&quot;, []],</span><br><span class="line">   &quot;GetWindowTextA&quot;: [&quot;int32&quot;, [&quot;int32&quot;, &quot;string&quot;, &quot;int32&quot;]],</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export function GetForegroundWindowText() &#123;</span><br><span class="line">	var buffer = new Buffer(256);</span><br><span class="line">	buffer.type = ref.types.CString;</span><br><span class="line">    var handle = user32.GetForegroundWindow();</span><br><span class="line">    let length = user32.GetWindowTextA(handle, buffer, 256);</span><br><span class="line">    return buffer.toString().substr(0, length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://discuss.atom.io/t/active-window-title-of-other-applications/25409" target="_blank" rel="noopener">Active window title of other applications</a></p>
<h2 id="版本管理"><a href="#版本管理" class="headerlink" title="版本管理"></a><a href="https://electronjs.org/docs/tutorial/electron-versioning#electron-%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86" target="_blank" rel="noopener">版本管理</a></h2><p>从版本 2.0.0, Electron 遵循 <a href="https://electronjs.org/docs/tutorial/electron-versioning#semver" target="_blank" rel="noopener">semver </a>。版本号中的各位对应 Major(大版本号).Minor(小版本号).Patch(补丁号)</p>
<table>
<thead>
<tr>
<th>Major 版本增量</th>
<th>Minor 版本增量</th>
<th>Patch 版本增量</th>
</tr>
</thead>
<tbody>
<tr>
<td>Electron 突破性 API 变更</td>
<td>Electron 无突破性 API 变更</td>
<td>Electron bug 修复</td>
</tr>
<tr>
<td>Node.js 重大版本更新</td>
<td>Node.js 次要版本更新</td>
<td>Node.js patch 版本更新</td>
</tr>
<tr>
<td>Chromium 版本更新</td>
<td></td>
<td>修复相关的 chromium 补丁</td>
</tr>
</tbody>
</table>
<p>在 <code>package.json</code> 中用以下方式控制版本更新的范围:</p>
<ul>
<li>兼容新发布的补丁版本：~2.2.0、2.2.x、2.2</li>
<li>兼容新发布的小版本、补丁版本：^2.2.0、2.x、2</li>
<li>兼容新发布的大版本、小版本、补丁版本：*、x</li>
</ul>
<h3 id="更新electron"><a href="#更新electron" class="headerlink" title="更新electron"></a>更新electron</h3><p>现有项目更新到最新的稳定版本:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev electron@latest</span><br></pre></td></tr></table></figure>
<p>查看本地版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm ls electron -g</span><br></pre></td></tr></table></figure>
<p>查看服务器最新版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm view electron version</span><br></pre></td></tr></table></figure>
<h3 id="更新-node-版本"><a href="#更新-node-版本" class="headerlink" title="更新 node 版本"></a>更新 node 版本</h3><p>Electron 有它自己的 <a href="https://github.com/electron/node" target="_blank" rel="noopener">Node 克隆</a>, 并对 V8 构建细节进行修改, 并用于暴露Electron所需的 API。</p>
<p>检查 <a href="https://github.com/electron/node" target="_blank" rel="noopener">Node 克隆</a> 中是否有 node 更新：</p>
<table>
<thead>
<tr>
<th></th>
<th><strong>5-0-x</strong></th>
<th><strong>4-0-x</strong></th>
<th><strong>3-0-x</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Chromium</td>
<td>v72.0.3626.52</td>
<td>v69.0.3497.106</td>
<td>v66.0.3359.181</td>
</tr>
<tr>
<td>Node</td>
<td><a href="https://github.com/electron/node/tree/electron-node-v12.x" target="_blank" rel="noopener">v12.0.0-unreleased</a></td>
<td><a href="https://github.com/electron/node/tree/electron-node-v10.11.0-V8-6.9" target="_blank" rel="noopener">v10.11.0</a></td>
<td><a href="https://github.com/electron/node/tree/electron-node-v10.2.0" target="_blank" rel="noopener">v10.2.0</a></td>
</tr>
<tr>
<td>V8</td>
<td>7.2.502.19</td>
<td>v6.9.427.24</td>
<td>v6.6.346.23</td>
</tr>
</tbody>
</table>
<h2 id="常见坑"><a href="#常见坑" class="headerlink" title="常见坑"></a>常见坑</h2><h3 id="复制粘贴用不了"><a href="#复制粘贴用不了" class="headerlink" title="复制粘贴用不了"></a><a href="http://www.loen.wang/?p=728" target="_blank" rel="noopener">复制粘贴用不了</a></h3><p>mac需要设置应用菜单栏，才能映射编辑的相关快捷键，否则按键无效；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置应用菜单，映射常用快捷键</span></span><br><span class="line"><span class="keyword">var</span> appMenu = [</span><br><span class="line">  &#123; <span class="attr">label</span>: <span class="string">'Application'</span>,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">'About Application'</span>, <span class="attr">selector</span>: <span class="string">'orderFrontStandardAboutPanel:'</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">'separator'</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">'Quit'</span>, <span class="attr">accelerator</span>: <span class="string">'Command+Q'</span>, <span class="attr">click</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; app.quit() &#125; &#125;</span><br><span class="line">    ]&#125;,</span><br><span class="line">  &#123; <span class="attr">label</span>: <span class="string">'Edit'</span>,</span><br><span class="line">    submenu: [</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">'Undo'</span>, <span class="attr">accelerator</span>: <span class="string">'CmdOrCtrl+Z'</span>, <span class="attr">selector</span>: <span class="string">'undo:'</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">'Redo'</span>, <span class="attr">accelerator</span>: <span class="string">'Shift+CmdOrCtrl+Z'</span>, <span class="attr">selector</span>: <span class="string">'redo:'</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">type</span>: <span class="string">'separator'</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">'Cut'</span>, <span class="attr">accelerator</span>: <span class="string">'CmdOrCtrl+X'</span>, <span class="attr">selector</span>: <span class="string">'cut:'</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">'Copy'</span>, <span class="attr">accelerator</span>: <span class="string">'CmdOrCtrl+C'</span>, <span class="attr">selector</span>: <span class="string">'copy:'</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">'Paste'</span>, <span class="attr">accelerator</span>: <span class="string">'CmdOrCtrl+V'</span>, <span class="attr">selector</span>: <span class="string">'paste:'</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">label</span>: <span class="string">'Select All'</span>, <span class="attr">accelerator</span>: <span class="string">'CmdOrCtrl+A'</span>, <span class="attr">selector</span>: <span class="string">'selectAll:'</span> &#125;</span><br><span class="line">    ]&#125;</span><br><span class="line">]</span><br><span class="line">Menu.setApplicationMenu(Menu.buildFromTemplate(appMenu))</span><br></pre></td></tr></table></figure>
</div><div class="tags"><a href="/tags/electron/">electron</a></div><div class="post-nav"><a class="pre" href="/2018/01/06/html css学习笔记/">html css学习笔记</a><a class="next" href="/2017/12/01/javascript学习笔记/">javascript学习笔记</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://yodu.xyz"></form></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">有度.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></div></div></div><a id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>